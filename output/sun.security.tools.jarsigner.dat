Main#main(String[])::: main main:::js->new->Main->js->run
Main#run(String[])::: main run:::try->parseArgs->if->foreach->try->KeyStoreUtil->providerArgs->get->loadProviderByName->if->println->catch->throw->String->rb->getString->format->new->Exception->finally->if->cl->ClassLoader->getSystemClassLoader->foreach->try->KeyStoreUtil->providerArgs->get->loadProviderByClass->if->println->catch->throw->String->rb->getString->format->new->Exception->throw->String->rb->getString->format->e->getCause->new->Exception->finally->if->try->loadKeyStore->catch->if->rb->getString->e->getMessage->println->if->e->printStackTrace->System->exit->finally->verifyJar->else->loadKeyStore->getAliasInfo->signJar->catch->rb->getString->println->if->e->printStackTrace->System->exit->finally->if->Arrays->fill->if->Arrays->fill->if->exitCode->if->if->if->if->if->if->System->exit
Main#parseArgs(String[])::: main parse args:::n->if->fullusage->confFile->command->for->if->KeyStoreUtil->expandArgs->Arrays->stream->collator->compare->anyMatch->if->Arrays->toString->println->for->if->if->rb->getString->println->usage->if->rb->getString->println->usage->if->ckaliases->size->rb->getString->println->usage->if->KeyStore->getDefaultType->KeyStoreUtil->niceStoreTypeName->try->if->new->File->getCanonicalPath->new->File->getCanonicalPath->equals->catch->finally->if->P11KEYSTORE->equalsIgnoreCase->KeyStoreUtil->isWindowsKeyStore->if->if->NONE->equals->if->MessageFormat->rb->getString->format->println->usage->if->MessageFormat->rb->getString->format->println->usage->if->if->rb->getString->println->usage->if->KeyStoreUtil->isWindowsKeyStore->if->rb->getString->println->usage->return
Main#getPass(String, String)::: main get pass:::output->KeyStoreUtil->getPassWithModifier->if->return->usage->return
Main#usageNoArg()::: main usage no arg:::rb->getString->println->usage
Main#usage()::: main usage:::println->rb->getString->println->System->exit
Main#fullusage()::: main fullusage:::rb->getString->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->rb->getString->println->println->rb->getString->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->rb->getString->println->println->System->exit
Main#verifyJar(String)::: main verify jar:::anySigned->jf->digestMap->new->HashMap<>->sigMap->new->HashMap<>->sigNameMap->new->HashMap<>->unparsableSignatures->new->HashMap<>->try->new->JarFile->entriesVec->new->Vector<>->buffer->new->byteArr->entries->jf->entries->while->entries->hasMoreElements->je->entries->nextElement->entriesVec->addElement->try->is->jf->getInputStream->name->je->getName->if->signatureRelated->SignatureFileVerifier->isBlockOrSF->alias->name->name->lastIndexOf->name->lastIndexOf->substring->try->if->name->endsWith->sf->new->Manifest->found->foreach->sf->getMainAttributes->keySet->key->obj->toString->if->key->endsWith->digestMap->key->key->length->substring->put->break->if->unparsableSignatures->String->rb->getString->format->putIfAbsent->else->sigNameMap->put->sigMap->new->PKCS7->put->catch->unparsableSignatures->String->rb->getString->format->putIfAbsent->finally->else->while->is->read->catch->finally->man->jf->getManifest->hasSignature->output->new->LinkedHashMap<>->if->if->println->e->entriesVec->elements->tab->rb->getString->while->e->hasMoreElements->je->e->nextElement->name->je->getName->SignatureFileVerifier->isBlockOrSF->signers->je->getCodeSigners->isSigned->je->isDirectory->signatureRelated->inStoreWithAlias->inKeyStore->inStore->if->sb->if->new->StringBuffer->inManifest->man->getAttributes->man->getAttributes->man->getAttributes->sb->rb->getString->rb->getString->append->rb->getString->rb->getString->append->rb->getString->rb->getString->append->append->rb->getString->append->sb->append->if->if->sb->append->foreach->si->signerInfo->if->sb->append->sb->append->else->if->verbose->equals->if->signatureRelated->sb->append->append->rb->getString->append->append->else->sb->append->append->rb->getString->append->append->if->label->sb->toString->if->signatureRelated->if->output->containsKey->output->new->ArrayList<String>->put->fb->new->StringBuilder->s->Long->je->getSize->toString->for->i->s->length->fb->append->append->je->getTime->new->Date->toString->append->fb->append->append->output->get->fb->toString->add->if->foreach->output->entrySet->files->s->getValue->key->s->getKey->if->key->charAt->key->substring->pipe->key->indexOf->if->verbose->equals->foreach->key->substring->println->key->substring->printf->else->if->verbose->equals->foreach->key->substring->println->else->if->verbose->equals->key->substring->print->if->files->size->files->get->String->rb->getString->files->size->format->println->else->files->get->println->key->substring->printf->println->rb->getString->println->rb->getString->println->rb->getString->println->if->ckaliases->size->rb->getString->println->if->println->rb->getString->println->if->if->digestMap->isEmpty->sigMap->isEmpty->unparsableSignatures->isEmpty->if->println->foreach->sigMap->keySet->if->digestMap->containsKey->unparsableSignatures->String->rb->getString->format->putIfAbsent->foreach->digestMap->keySet->p7->sigMap->get->if->history->try->si->p7->getSignerInfos->signer->si->getCertificate->digestAlg->digestMap->get->sigAlg->AlgorithmId->si->getDigestAlgorithmId->getName->si->getDigestEncryptionAlgorithmId->getName->makeSigAlg->key->signer->getPublicKey->tsToken->si->getTsToken->if->tsSi->tsToken->getSignerInfos->tsSigner->tsSi->getCertificate->encTsTokenInfo->tsToken->getContentInfo->getData->tsTokenInfo->new->TimestampToken->tsKey->tsSigner->getPublicKey->tsDigestAlg->tsTokenInfo->getHashAlgorithm->getName->tsSigAlg->AlgorithmId->tsSi->getDigestAlgorithmId->getName->tsSi->getDigestEncryptionAlgorithmId->getName->makeSigAlg->c->Calendar->TimeZone->getTimeZone->Locale->getDefault->getInstance->c->tsTokenInfo->getDate->setTime->String->rb->getString->signer->getSubjectX500Principal->withWeak->withWeak->withWeak->tsSigner->getSubjectX500Principal->withWeak->withWeak->withWeak->format->else->String->rb->getString->signer->getSubjectX500Principal->withWeak->withWeak->withWeak->format->catch->String->rb->getString->sigNameMap->get->format->finally->if->println->else->unparsableSignatures->String->rb->getString->format->putIfAbsent->if->foreach->unparsableSignatures->keySet->unparsableSignatures->get->println->println->if->if->if->rb->getString->println->Security->getProperty->println->else->rb->getString->println->else->if->rb->getString->println->else->rb->getString->println->else->displayMessagesAndResult->return->catch->rb->getString->println->if->e->printStackTrace->finally->if->jf->close->System->exit
Main#displayMessagesAndResult(boolean)::: main display messages and result:::result->errors->new->ArrayList<>->warnings->new->ArrayList<>->info->new->ArrayList<>->signerNotExpired->expireDate->new->Date->after->if->if->rb->getString->else->rb->getString->if->errors->rb->getString->add->if->errors->rb->getString->add->if->errors->rb->getString->add->if->errors->rb->getString->add->if->errors->rb->getString->add->if->errors->rb->getString->add->if->errors->String->rb->getString->chainNotValidatedReason->getLocalizedMessage->format->add->if->errors->rb->getString->add->if->errors->String->rb->getString->tsaChainNotValidatedReason->getLocalizedMessage->format->add->if->errors->rb->getString->add->if->errors->rb->getString->add->if->errors->rb->getString->add->if->errors->String->rb->getString->format->add->if->errors->String->rb->getString->format->add->if->errors->String->rb->getString->format->add->if->errors->String->rb->getString->privateKey->getAlgorithm->KeyUtil->getKeySize->format->add->else->rb->getString->if->if->if->if->warnings->String->rb->getString->format->add->if->warnings->rb->getString->add->if->if->expireDate->after->warnings->String->rb->getString->format->add->else->warnings->String->rb->getString->format->add->if->if->warnings->String->rb->getString->format->add->else->warnings->String->rb->getString->format->add->println->if->if->errors->isEmpty->println->rb->getString->println->errors->System.out->println->forEach->if->warnings->isEmpty->println->rb->getString->println->warnings->System.out->println->forEach->else->if->errors->isEmpty->warnings->isEmpty->println->rb->getString->println->errors->System.out->println->forEach->warnings->System.out->println->forEach->if->errors->isEmpty->warnings->isEmpty->if->println->rb->getString->println->if->if->info->String->rb->getString->format->add->if->if->if->info->String->rb->getString->format->add->else->info->String->rb->getString->format->add->if->info->isEmpty->println->info->System.out->println->forEach
Main#withWeak(String, Set)::: main with weak:::if->DISABLED_CHECK->permits->return->else->return->String->rb->getString->format
Main#withWeak(PublicKey)::: main with weak:::if->DISABLED_CHECK->permits->kLen->KeyUtil->getKeySize->if->return->String->rb->getString->format->else->return->rb->getString->else->return->String->rb->getString->KeyUtil->getKeySize->format
Main#printCert(boolean, String, Certificate, Date, boolean):::Returns a string about a certificate:  [<tab>] <cert-type> [", " <subject-DN>] [" (" <keystore-entry-alias> ")"] [<validity-period> | <expiry-warning>] [<key-usage-warning>]  Note: no newline character at the end:::certStr->new->StringBuilder->space->rb->getString->x509Cert->if->certStr->append->x509Cert->getType->append->rb->getString->append->x509Cert->getSubjectDN->getName->append->else->certStr->append->c->getType->append->alias->storeHash->get->if->certStr->append->append->if->certStr->append->append->append->if->trustedCerts->contains->certStr->rb->getString->append->else->notAfter->x509Cert->getNotAfter->try->printValidity->if->if->tsaExpireDate->after->else->if->expireDate->after->if->x509Cert->checkValidity->age->if->notAfter->getTime->System->currentTimeMillis->if->else->if->rb->getString->new->MessageFormat->source->certStr->expiringTimeForm->format->append->else->x509Cert->checkValidity->if->if->rb->getString->new->MessageFormat->source->x509Cert->getNotBefore->certStr->validityTimeForm->format->append->catch->if->else->if->rb->getString->new->MessageFormat->source->certStr->expiredTimeForm->format->append->if->if->rb->getString->new->MessageFormat->source->x509Cert->getNotBefore->certStr->notYetTimeForm->format->append->finally->certStr->append->if->bad->new->booleanArr->checkCertUsage->if->x->if->if->if->x->length->if->if->x->length->certStr->append->append->MessageFormat->rb->getString->format->append->return->certStr->toString
Main#printTimestamp(String, Timestamp)::: main print timestamp:::if->rb->getString->new->MessageFormat->source->timestamp->getTimestamp->return->new->StringBuilder->append->append->signTimeForm->format->append->append->toString
Main#inKeyStoreForOneSigner(CodeSigner)::: main in key store for one signer:::if->cacheForInKS->containsKey->return->cacheForInKS->get->result->certs->signer->getSignerCertPath->getCertificates->foreach->alias->storeHash->get->if->if->alias->startsWith->if->ckaliases->alias->alias->length->substring->contains->else->if->try->store->getCertificateAlias->catch->finally->if->storeHash->put->if->ckaliases->contains->cacheForInKS->put->return
Main#inKeyStore(CodeSigner[])::: main in key store:::if->return->output->foreach->result->inKeyStoreForOneSigner->if->ckaliases->size->return
Main#signJar(String, String)::: main sign jar:::if->DISABLED_CHECK->permits->if->DISABLED_CHECK->permits->if->DISABLED_CHECK->permits->if->DISABLED_CHECK->permits->aliasUsed->tsaCert->if->if->sigfile->length->sigfile->substring->toUpperCase->else->sigfile->toUpperCase->tmpSigFile->sigfile->length->new->StringBuilder->for->j->sigfile->length->tmpSigFile->toString->tmpJarName->if->else->jarFile->new->File->signedJarFile->new->File->try->new->ZipFile->catch->rb->getString->error->finally->cp->CertificateFactory->getInstance->Arrays->asList->generateCertPath->builder->new->JarSigner.Builder->if->builder->rb->getString->println->eventHandler->if->builder->digestAlgorithm->if->builder->signatureAlgorithm->tsaURI->if->new->URI->else->if->getTsaCert->TimestampedSigner->getTimestampingURI->if->if->rb->getString->println->if->rb->getString->println->else->if->rb->getString->printCert->println->builder->tsa->if->builder->setProperty->if->builder->setProperty->if->builder->setProperty->if->rb->getString->println->if->builder->setProperty->builder->signerName->builder->Boolean->toString->setProperty->builder->Boolean->toString->setProperty->fos->try->new->FileOutputStream->catch->rb->getString->error->finally->failedCause->failedMessage->try->builder->build->sign->catch->e->getCause->if->rb->getString->rb->getString->rb->getString->else->if->rb->getString->rb->getString->finally->if->zipFile->close->if->fos->close->if->signedJarFile->delete->error->if->println->try->check->new->JarFile->p7->check->check->privateKey->getAlgorithm->getEntry->getInputStream->new->PKCS7->ts->try->si->p7->getSignerInfos->if->si->getTsToken->si->getTimestamp->catch->finally->result->Arrays->asList->certsAndTSInfo->if->println->catch->if->e->printStackTrace->finally->if->if->signedJarFile->renameTo->origJar->new->File->if->jarFile->renameTo->if->signedJarFile->renameTo->origJar->delete->else->form->rb->getString->new->MessageFormat->source->form->format->error->else->form->rb->getString->new->MessageFormat->source->form->format->error->displayMessagesAndResult
Main#signatureRelated(String):::signature-related files include: :::return->SignatureFileVerifier->isSigningRelated
Main#signerInfo(CodeSigner, String):::Returns a string of signer info, with a newline at the end:::if->cacheForSignerInfo->containsKey->return->cacheForSignerInfo->get->certs->signer->getSignerCertPath->getCertificates->ts->signer->getTimestamp->tsLine->if->printTimestamp->result->certsAndTSInfo->cacheForSignerInfo->put->return
Main#certsAndTSInfo(String, String, List, Timestamp):::Fills info on certs and timestamp into a StringBuilder, sets warning flags (through printCert) and validates cert chains.:::timestamp->if->ts->getTimestamp->else->first->sb->new->StringBuilder->sb->append->rb->getString->append->append->foreach->sb->printCert->append->sb->append->try->validateCertChain->catch->sb->append->rb->getString->append->e->getLocalizedMessage->append->append->finally->if->sb->append->rb->getString->append->append->foreach->ts->getSignerCertPath->getCertificates->sb->printCert->append->sb->append->try->ts->getSignerCertPath->getCertificates->validateCertChain->catch->sb->append->rb->getString->append->e->getLocalizedMessage->append->append->finally->if->certs->size->KeyStoreUtil->certs->get->isSelfSigned->return->sb->toString
Main#loadKeyStore(String, boolean)::: main load key store:::if->System->getProperty->try->try->caks->KeyStoreUtil->getCacertsKeyStore->if->aliases->caks->aliases->while->aliases->hasMoreElements->a->aliases->nextElement->try->trustedCerts->caks->getCertificate->add->catch->finally->catch->finally->if->KeyStore->getInstance->else->KeyStore->getInstance->if->KeyStoreUtil->isWindowsKeyStore->rb->getString->getPass->else->if->rb->getString->getPass->try->if->store->load->else->keyStoreName->replace->url->try->new->URL->catch->new->File->toURI->toURL->finally->is->try->url->openStream->store->load->catch->finally->if->is->close->aliases->store->aliases->while->aliases->hasMoreElements->a->aliases->nextElement->try->c->store->getCertificate->if->store->isCertificateEntry->c->getSubjectDN->c->getIssuerDN->equals->trustedCerts->add->catch->finally->catch->finally->try->trustedCerts->stream->new->TrustAnchor->map->Collectors->toSet->collect->new->PKIXBuilderParameters->pkixParameters->setRevocationEnabled->catch->finally->catch->throw->rb->getString->ioe->getMessage->new->RuntimeException->throw->rb->getString->ce->getMessage->new->RuntimeException->throw->rb->getString->pe->getMessage->new->RuntimeException->throw->rb->getString->nsae->getMessage->new->RuntimeException->throw->rb->getString->kse->getMessage->new->RuntimeException->finally
Main#getTsaCert(String)::: main get tsa cert:::cs->try->store->getCertificate->catch->finally->if->form->rb->getString->new->MessageFormat->source->form->format->error->return
Main#checkCertUsage(X509Certificate, boolean[]):::Check if userCert is designed to be a code signer:::if->keyUsage->userCert->getKeyUsage->if->Arrays->copyOf->if->if->try->xKeyUsage->userCert->getExtendedKeyUsage->if->if->xKeyUsage->contains->xKeyUsage->contains->if->catch->finally->try->netscapeEx->userCert->getExtensionValue->if->in->new->DerInputStream->encoded->in->getOctetString->new->DerValue->getUnalignedBitString->toByteArray->extn->new->NetscapeCertTypeExtension->val->extn->get->if->if->catch->finally
Main#getAliasInfo(String)::: main get alias info:::key->try->cs->if->try->fis->new->FileInputStream->CertificateFactory->getInstance->generateCertificates->new->CertificateArr->toArray->catch->rb->getString->error->rb->getString->error->finally->else->try->store->getCertificateChain->catch->finally->if->if->rb->getString->error->else->form->rb->getString->new->MessageFormat->source->form->format->error->new->X509CertificateArr->for->i->try->if->store->getKey->else->store->getKey->catch->if->throw->else->if->form->rb->getString->new->MessageFormat->source->form->format->getPass->store->getKey->finally->catch->e->getMessage->error->rb->getString->error->finally->if->form->rb->getString->new->MessageFormat->source->form->format->error->else
Main#error(String)::: main error:::rb->getString->println->System->exit
Main#error(String, Throwable)::: main error:::rb->getString->println->if->e->printStackTrace->System->exit
Main#validateCertChain(String, List, Timestamp):::Validates a cert chain.:::try->Validator->getInstance->certs->certs->size->new->X509CertificateArr->toArray->validate->catch->if->e->printStackTrace->if->variant->equals->if->e->getCause->e->getCause->e->getCause->t->e->getCause->if->return->if->variant->equals->if->e->getCause->e->getCause->e->getCause->t->e->getCause->if->return->if->ve->if->ve->getErrorType->return->throw->finally
Main#getPass(String)::: main get pass:::print->flush->try->pass->Password->readPassword->if->rb->getString->error->else->return->catch->rb->getString->ioe->getMessage->error->finally->return
Resources#getContents():::Returns the contents of this ResourceBundle:::return
Resources_ja#getContents():::Returns the contents of this ResourceBundle:::return
Resources_zh_CN#getContents():::Returns the contents of this ResourceBundle:::return
TimestampedSigner#generateSignedData(ContentSignerParameters, boolean, boolean):::Generates a PKCS #7 signed data message that includes a signature timestamp:::if->throw->new->NullPointerException->signatureAlgorithm->params->getSignatureAlgorithm->signerChain->params->getSignerCertificateChain->signature->params->getSignature->content->params->getContent->tsaURI->if->params->getTimestampingAuthority->if->params->getTimestampingAuthorityCertificate->getTimestampingURI->if->throw->new->CertificateException->return->PKCS7->params->getSignatureAlgorithm->params->getTSAPolicyID->params->getTSADigestAlg->generateSignedData
TimestampedSigner#getTimestampingURI(X509Certificate):::Examine the certificate for a Subject Information Access extension (RFC 5280):::if->return->try->extensionValue->tsaCertificate->getExtensionValue->if->return->der->new->DerInputStream->der->getOctetString->new->DerInputStream->derValue->der->getSequence->description->location->uri->for->i->catch->finally->return
